<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YAP Visual Builder - Test Runner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #0073aa;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .header p {
            color: #666;
            font-size: 14px;
        }
        
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section h2 {
            color: #0073aa;
            font-size: 18px;
            margin-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 12px;
        }
        
        .test-item {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            transition: all 0.3s ease;
        }
        
        .test-item:hover {
            border-color: #0073aa;
            box-shadow: 0 2px 6px rgba(0,115,170,0.1);
        }
        
        .test-item h3 {
            color: #333;
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .test-item p {
            color: #666;
            font-size: 12px;
            line-height: 1.5;
        }
        
        .test-icon {
            font-size: 16px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            background: #0073aa;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: #005a87;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,115,170,0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button.secondary {
            background: #666;
        }
        
        button.secondary:hover {
            background: #555;
        }
        
        button.success {
            background: #46b450;
        }
        
        button.success:hover {
            background: #3a9143;
        }
        
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0073aa;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-size: 13px;
            color: #333;
            line-height: 1.6;
        }
        
        .info-box strong {
            color: #0073aa;
        }
        
        .code-block {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            color: #333;
            margin: 10px 0;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status.ready {
            background: #e7f3ff;
            color: #0073aa;
        }
        
        .status.running {
            background: #fff8e7;
            color: #b8860b;
        }
        
        .status.passed {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        footer {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            font-size: 12px;
            color: #666;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üß™ YAP Visual Builder - Test Runner</h1>
            <p>Kompleksowe testy edycji p√≥l w Visual Builderze</p>
        </div>
        
        <!-- Info -->
        <div class="info-box">
            <strong>‚ö†Ô∏è Wa≈ºne:</strong> Otw√≥rz Visual Builder w WordPress admin panelu w osobnej karcie, 
            a nastƒôpnie uruchamiaj testy z tej karty. Testy bƒôdƒÖ interaktywnie kontrolowaƒá Visual Builder.
        </div>
        
        <!-- Basic Tests -->
        <div class="test-section">
            <h2>üß™ Testy Podstawowe</h2>
            <p style="color: #666; margin-bottom: 15px; font-size: 13px;">
                Podstawowe funkcje edycji p√≥l w Visual Builderze
            </p>
            <div class="test-grid">
                <div class="test-item">
                    <h3><span class="test-icon">üìù</span> Otwieranie Modalu</h3>
                    <p>Test otwierania okna dialogowego edycji pola</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">‚úèÔ∏è</span> Zmiana Nazwy Pola</h3>
                    <p>Test zmiany nazwy pola (Field Name)</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üè∑Ô∏è</span> Zmiana Etykiety</h3>
                    <p>Test zmiany etykiety (Field Label)</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üìå</span> Placeholder</h3>
                    <p>Test zmiany tekstu podpowiedzi (Placeholder)</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">‚öôÔ∏è</span> Warto≈õƒá Domy≈õlna</h3>
                    <p>Test zmiany warto≈õci domy≈õlnej pola</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üìñ</span> Opis</h3>
                    <p>Test zmiany opisu i instrukcji pola</p>
                </div>
            </div>
            
            <div class="button-group">
                <button onclick="loadAndRunBasicTests()">
                    <span>‚ñ∂Ô∏è</span> Uruchom Testy Podstawowe
                </button>
                <button class="secondary" onclick="openVisualBuilder()">
                    <span>üîó</span> Otw√≥rz Visual Builder
                </button>
            </div>
        </div>
        
        <!-- Advanced Tests -->
        <div class="test-section">
            <h2>üîÑ Testy Zaawansowane</h2>
            <p style="color: #666; margin-bottom: 15px; font-size: 13px;">
                Z≈Ço≈ºone scenariusze i kombinacje opcji p√≥l
            </p>
            <div class="test-grid">
                <div class="test-item">
                    <h3><span class="test-icon">üé®</span> Kombinacje Opcji</h3>
                    <p>Testowanie 5 r√≥≈ºnych kombinacji opcji podstawowych</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">‚ö°</span> Logika Warunkowa</h3>
                    <p>Testy warunkowej widoczno≈õci z 6 operatorami</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üîó</span> Pola Zagnie≈ºd≈ºone</h3>
                    <p>Edycja p√≥l wewnƒÖtrz Groups i Repeaters</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">‚Ü©Ô∏è</span> Modyfikacja i Przywr√≥cenie</h3>
                    <p>Test Save/Cancel - przywr√≥cenie warto≈õci</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üî§</span> Znaki Specjalne</h3>
                    <p>Test warto≈õci ze spacjami, HTML, znakami specjalnymi</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üí®</span> Szybkie Zmiany</h3>
                    <p>Test sekwencyjnych zmian w szybkim tempie</p>
                </div>
            </div>
            
            <div class="button-group">
                <button class="success" onclick="loadAndRunAdvancedTests()">
                    <span>‚ñ∂Ô∏è</span> Uruchom Testy Zaawansowane
                </button>
            </div>
        </div>
        
        <!-- Field Property Tests -->
        <div class="test-section">
            <h2>üéØ Testy Konkretnych W≈Ça≈õciwo≈õci</h2>
            <div class="test-grid">
                <div class="test-item">
                    <h3><span class="test-icon">‚≠ê</span> Pole Wymagane</h3>
                    <p>Zaznaczanie/odznaczanie checkboxa wymaganego pola</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üé®</span> CSS Class</h3>
                    <p>Dodawanie i modyfikowanie klas CSS</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üìã</span> Prze≈ÇƒÖczanie Tab√≥w</h3>
                    <p>Test nawigacji miƒôdzy zak≈Çadkami Og√≥lne/Zaawansowane/Warunki</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üîê</span> Walidacja Nazwy</h3>
                    <p>Testowanie poprawno≈õci nazwy pola (a-z, 0-9, _)</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üóëÔ∏è</span> Zamkniƒôcie Modalu</h3>
                    <p>Test ESC, klikniecie overlay, przycisk Cancel</p>
                </div>
                <div class="test-item">
                    <h3><span class="test-icon">üíæ</span> Persystencja</h3>
                    <p>Weryfikacja, ≈ºe zmiany siƒô zapisujƒÖ</p>
                </div>
            </div>
            
            <div class="button-group">
                <button onclick="runSpecificTest('testChangeFieldName')">
                    Zmiana Nazwy
                </button>
                <button onclick="runSpecificTest('testChangeFieldLabel')">
                    Zmiana Etykiety
                </button>
                <button onclick="runSpecificTest('testToggleRequired')">
                    Pole Wymagane
                </button>
                <button onclick="runSpecificTest('testChangeCSSOClass')">
                    CSS Class
                </button>
                <button onclick="runSpecificTest('testSaveAndClose')">
                    Save & Close
                </button>
            </div>
        </div>
        
        <!-- Instructions -->
        <div class="test-section">
            <h2>üìö Instrukcje U≈ºytkowania</h2>
            
            <h3 style="color: #0073aa; font-size: 14px; margin-top: 15px; margin-bottom: 8px;">1Ô∏è‚É£ Przygotowanie</h3>
            <div class="code-block">
1. Otw√≥rz WordPress Admin Panel
2. Przejd≈∫ do: Dashboard ‚Üí Page Builder (YAP)
3. Otw√≥rz lub stw√≥rz schematem pola
4. Powr√≥ƒá do tej karty przeglƒÖdarki
            </div>
            
            <h3 style="color: #0073aa; font-size: 14px; margin-top: 15px; margin-bottom: 8px;">2Ô∏è‚É£ Uruchomienie Test√≥w</h3>
            <div class="code-block">
Opcja A: Kliknij przycisk "Uruchom Testy"
Opcja B: Otw√≥rz DevTools (F12) ‚Üí Console i wpisz:
  - YAPBuilderTests.runAll()
  - YAPAdvancedTests.runAll()
            </div>
            
            <h3 style="color: #0073aa; font-size: 14px; margin-top: 15px; margin-bottom: 8px;">3Ô∏è‚É£ Czytanie Wynik√≥w</h3>
            <div class="code-block">
‚úÖ Zielony - Test przeszed≈Ç
‚ùå Czerwony - Test nie przeszed≈Ç
üß™ Niebieski - Informacja testowa
‚ÑπÔ∏è Szary - Informacja dodatkowo
            </div>
            
            <h3 style="color: #0073aa; font-size: 14px; margin-top: 15px; margin-bottom: 8px;">4Ô∏è‚É£ Debugowanie</h3>
            <p style="color: #666; font-size: 13px; line-height: 1.6;">
                Je≈õli test siƒô nie powiedzie, sprawd≈∫ w DevTools ‚Üí Console:
            </p>
            <div class="code-block">
‚Ä¢ Czy modal siƒô otwiera?
‚Ä¢ Czy elementy formularza sƒÖ znalezione?
‚Ä¢ Czy eventy uruchamiajƒÖ siƒô?
‚Ä¢ Czy warto≈õci siƒô aktualizujƒÖ?
            </div>
        </div>
        
        <!-- Console Output -->
        <div class="test-section">
            <h2>üìü Wyj≈õcie Konsoli</h2>
            <div id="console-output" style="
                background: #1e1e1e;
                color: #d4d4d4;
                padding: 15px;
                border-radius: 6px;
                font-family: 'Courier New', monospace;
                font-size: 12px;
                max-height: 400px;
                overflow-y: auto;
                line-height: 1.4;
            ">
                <div style="color: #6a9955;">// Konsola test√≥w pojawia siƒô tutaj</div>
                <div style="color: #808080;">Otw√≥rz DevTools (F12) aby zobaczyƒá pe≈Çne logi</div>
            </div>
            <button style="margin-top: 10px;" onclick="clearConsole()">
                üóëÔ∏è Wyczy≈õƒá Konsolƒô
            </button>
        </div>
        
        <!-- Footer -->
        <footer>
            <p>üß™ YAP Visual Builder Test Suite v1.0</p>
            <p>Testy dla YetAnotherPlugin Visual Builder</p>
        </footer>
    </div>
    
    <script>
        // Pobierz i uruchom testy podstawowe
        function loadAndRunBasicTests() {
            // Sprawd≈∫ czy Visual Builder jest dostƒôpny
            if (typeof window.opener === 'object' && window.opener !== null) {
                const vbWindow = window.opener;
                if (typeof vbWindow.YAPBuilderTests !== 'undefined') {
                    vbWindow.YAPBuilderTests.runAll();
                    alert('‚úÖ Testy podstawowe uruchomione w Visual Builderze');
                    return;
                }
            }
            
            // Je≈õli nie ma okna nadrzƒôdnego, ≈Çaduj testy w tej karcie
            loadTestFile('visual-builder-field-editing.test.js');
            alert('‚ÑπÔ∏è ≈Åadujƒô testy... Otw√≥rz DevTools (F12) i zobacz Console');
        }
        
        // Pobierz i uruchom testy zaawansowane
        function loadAndRunAdvancedTests() {
            if (typeof window.opener === 'object' && window.opener !== null) {
                const vbWindow = window.opener;
                if (typeof vbWindow.YAPAdvancedTests !== 'undefined') {
                    vbWindow.YAPAdvancedTests.runAll();
                    alert('‚úÖ Testy zaawansowane uruchomione w Visual Builderze');
                    return;
                }
            }
            
            loadTestFile('visual-builder-advanced.test.js');
            alert('‚ÑπÔ∏è ≈Åadujƒô testy... Otw√≥rz DevTools (F12) i zobacz Console');
        }
        
        // Za≈Çaduj plik testowy
        function loadTestFile(filename) {
            const script = document.createElement('script');
            script.src = `../tests/${filename}`;
            document.head.appendChild(script);
            
            setTimeout(() => {
                if (filename.includes('field-editing')) {
                    if (typeof YAPBuilderTests !== 'undefined') {
                        YAPBuilderTests.runAll();
                    }
                } else if (filename.includes('advanced')) {
                    if (typeof YAPAdvancedTests !== 'undefined') {
                        YAPAdvancedTests.runAll();
                    }
                }
            }, 500);
        }
        
        // Uruchom konkretny test
        function runSpecificTest(testName) {
            if (typeof YAPBuilderTests !== 'undefined' && typeof YAPBuilderTests[testName] === 'function') {
                console.clear();
                console.log(`‚ñ∂Ô∏è Uruchamianie: ${testName}`);
                YAPBuilderTests[testName]();
            } else {
                alert('Test niedostƒôpny. ≈Åadujƒô testy...');
                loadTestFile('visual-builder-field-editing.test.js');
            }
        }
        
        // Wyczy≈õƒá konsolƒô
        function clearConsole() {
            document.getElementById('console-output').innerHTML = 
                '<div style="color: #6a9955;">// Konsola wyczyszczona</div>';
            console.clear();
        }
        
        // Otw√≥rz Visual Builder
        function openVisualBuilder() {
            // Spr√≥buj znale≈∫ƒá URL Visual Buildera
            const adminUrl = '/wp-admin/';
            const vbUrl = adminUrl + '?page=yap-builder';
            window.open(vbUrl, 'visual-builder', 'width=1400,height=900');
        }
        
        // Inicjalizacja - ≈Çaduj testy przy za≈Çadowaniu strony
        document.addEventListener('DOMContentLoaded', function() {
            // Preload test files
            ['visual-builder-field-editing.test.js', 'visual-builder-advanced.test.js'].forEach(file => {
                const script = document.createElement('script');
                script.src = `../tests/${file}`;
                script.async = true;
                document.head.appendChild(script);
            });
        });
        
        // Przechwyƒá console.log i wy≈õwietl w UI
        const originalLog = console.log;
        const outputDiv = document.getElementById('console-output');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            
            const message = args.map(arg => {
                if (typeof arg === 'object') {
                    return JSON.stringify(arg, null, 2);
                }
                return String(arg);
            }).join(' ');
            
            const line = document.createElement('div');
            line.textContent = message;
            line.style.wordBreak = 'break-word';
            
            outputDiv.appendChild(line);
            outputDiv.scrollTop = outputDiv.scrollHeight;
        };
    </script>
</body>
</html>
